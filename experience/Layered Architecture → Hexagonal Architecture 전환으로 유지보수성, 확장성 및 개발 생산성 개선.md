# Layered Architecture → Hexagonal Architecture 전환으로 유지보수성, 확장성 및 개발 생산성 개선

### Situation

운영 3년 차에 접어든 Layered Architecture 기반 시스템은 시간이 흐르면서 비즈니스 로직이 복잡해졌고, 비즈니스 불변식이 여러 서비스에 흩어져 있어 **Service 클래스 간 순환 참조**가 발생하는 문제가 나타났습니다. 또한, 주요 데이터 모델이 **다대다(Many-to-Many) 관계**를 가지면서 이를 도메인 모델로 직접 활용하다 보니 **구현의 제약이 커지고 코드의 복잡도가 전역적으로 증가**했습니다. 

### Task

이를 해결하기 위해 **Hexagonal Architecture(Ports and Adapters Pattern) 적용을 제안**했습니다.

- 비즈니스 불변식을 한 곳에 모아 도메인 중심의 구조 확립, DB 모델 의존성 제거
- 서비스를 작은 단위로 분리하여 코드 중복 및 순환 참조 문제 해결
- 단위 테스트 작성이 용이하고 변경에 유연한 구조 마련

### Action

거대한 코드 베이스를 한 번에 변경하기 어려웠기 때문에 점진적으로 전환 전략을 수립하여 적용했습니다.

- 도메인 중심 구조로 점진적 개발
	- 새로 추가하는 기능에 대해 **In/Out Port 인터페이스를 경계로 도메인을 보호**
	- **의존성 방향을 단방향으로 설정**하여 서비스 간 결합도를 낮추도록 설계
- 2차 개선 계획 수립
	- 바운디드 컨텍스트(Bounded Context) 재조정
	- 각 도메인을 독립적인 모듈로 분리하여 빌드 아티팩트로 관리
	- 애플리케이션에서 불필요한 의존성을 제거
	- 애플리케이션 빌드 시간 축소

### Result

헥사고날 아키텍처 도입 후 동료 개발자들로부터 **도메인 중심의 코드 작성이 가능해졌고**, **단위 테스트 작성이 쉬워졌다는 피드백**을 받았습니다. 또한 서비스 결합도가 낮아지면서 **유지보수 및 확장성 향상** 되었고 **각 개발자가 코드 충돌없이 병렬 작업이 가능해져 개발 생산성이 높아졌습니다.** 물론 코드의 순환 참조 문제를 예방하는 효과도 얻을 수 있었습니다. 다만, 헥사고날 아키텍처 적용 전, 후의 코드 복잡도나 클래스 또는 패키지 간 순환 참조 등 코드 품질 수치를 기록해 두지 못한 점은 아쉬움으로 남습니다.
